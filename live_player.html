<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Competición - Jugador</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="css/styles.css" rel="stylesheet">
    <style>
        .char-correct {
            color: #4ade80;
        }

        .char-incorrect {
            color: #f87171;
            text-decoration: underline;
        }

        .char-current {
            background-color: rgba(99, 102, 241, 0.4);
            border-bottom: 2px solid var(--primary-color);
        }

        #hiddenInput {
            position: absolute;
            opacity: 0;
            top: 0;
            left: 0;
        }
    </style>
</head>

<body>

    <!-- Join Screen -->
    <div id="joinScreen" class="container vh-100 d-flex flex-column align-items-center justify-content-center">
        <div class="glass-panel p-5 text-center" style="max-width: 400px; width: 100%;">
            <h2 class="title-gradient mb-4">Unirse a Partida</h2>
            <input type="text" id="gamePinInput"
                class="form-control form-control-premium mb-3 text-center fs-3 letter-spacing-2" placeholder="PIN"
                maxlength="6">
            <button onclick="joinGame()" class="btn btn-premium w-100 btn-lg">Entrar</button>
        </div>
    </div>

    <!-- Waiting Screen -->
    <div id="waitingScreen" class="container vh-100 d-none flex-column align-items-center justify-content-center">
        <div class="glass-panel p-5 text-center fade-in">
            <div class="spinner-border text-primary mb-4" style="width: 3rem; height: 3rem;"></div>
            <h2 class="text-light">¡Estás dentro!</h2>
            <p class="text-dim">Mira a la pantalla principal...</p>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="container vh-100 d-none flex-column p-4">

        <div class="glass-panel p-3 mb-4 d-flex justify-content-between">
            <span class="text-dim">PPM: <span id="wpmDisplay" class="text-light fw-bold">0</span></span>
            <span class="text-dim">Progreso: <span id="progressDisplay" class="text-light fw-bold">0%</span></span>
        </div>

        <div class="glass-panel p-4 flex-grow-1 position-relative"
            onclick="document.getElementById('hiddenInput').focus()">
            <div id="textDisplay" class="lead text-secondary"
                style="font-family: 'Courier New', monospace; line-height: 1.8;"></div>
            <input type="text" id="hiddenInput" autocomplete="off">
        </div>

        <div id="resultOverlay"
            class="position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-95 d-none flex-column align-items-center justify-content-center"
            style="z-index: 20;">
            <h1 class="text-success fw-bold mb-3">¡Terminado!</h1>
            <h2 class="text-light mb-4">Mira el podio en la pantalla.</h2>
            <a href="dashboard_student.html" class="btn btn-outline-light">Salir</a>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/db.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/typing-engine.js"></script>
    <script src="js/live_player.js"></script>
</body>

</html>